/* Apenas se a o banco n√£o existir ainda */
CREATE DATABASE escola_db;
/* --- */

CREATE TABLE `escola_db`.`usuarios` (
    `id` INT(10) NOT NULL AUTO_INCREMENT, 
    `nome` VARCHAR(50) NOT NULL , 
    `CPF` VARCHAR(14),
    `sexo` int(1) NOT NULL ,
    `dataNasc` date,
    `email` varchar(30),
    `senha` varchar(100),
    PRIMARY KEY (`id`)
) AUTO_INCREMENT=1111111;

CREATE TABLE `escola_db`.`tipos` (
    `cod` INT(2) NOT NULL, 
    `nomeTipo` VARCHAR(10) NOT NULL,
    PRIMARY KEY (`cod`)
);

CREATE TABLE `escola_db`.`funcionarios` (
    `id` INT(10) NOT NULL, 
    `tipo` INT(2) NOT NULL,
    `salario` DECIMAL(5,2),
    FOREIGN KEY(`id`) REFERENCES usuarios(id),
    FOREIGN KEY(`tipo`) REFERENCES tipos(cod)
);

CREATE TABLE `escola_db`.`cursos` (
    `cod` INT(5) NOT NULL AUTO_INCREMENT, 
    `nomeCurso` varchar(30) NOT NULL,
    PRIMARY KEY (`cod`)
);

CREATE TABLE `escola_db`.`materias` (
    `cod` INT(5) NOT NULL AUTO_INCREMENT, 
    `codCurso` INT(5) NOT NULL , 
    `nomeMateria` varchar(30) NOT NULL,
    PRIMARY KEY (`cod`),
    FOREIGN KEY (`codCurso`) REFERENCES cursos(cod)
);

CREATE TABLE `escola_db`.`matriculas` (
    `cod` INT(10) NOT NULL AUTO_INCREMENT, 
    `raAluno` INT(10) NOT NULL , 
    `codCurso` INT(5) NOT NULL , 
    `mensalidade` DECIMAL(5,2),
    `dataMAtricula` date,
    `status` varchar(15) DEFAULT null ,
    PRIMARY KEY (`cod`),
    FOREIGN KEY (`raAluno`) REFERENCES usuarios(id),
    FOREIGN KEY (`codCurso`) REFERENCES cursos(cod)
);

CREATE TABLE `escola_db`.`notas` (
    `matricula` INT(10) NOT NULL , 
    `materia` INT(5), 
    `nota` INT(3),
    `status` varchar(15) DEFAULT null ,
    FOREIGN KEY (`matricula`) REFERENCES matriculas(cod),
    FOREIGN KEY (`materia`) REFERENCES materias(cod)
);

CREATE TABLE `escola_db`.`aulas` (
    `cod` INT(10) NOT NULL AUTO_INCREMENT, 
    `materia` INT(5) NOT NULL , 
    `idProfessor` INT(10) NOT NULL ,
    `nomeSala` varchar(15) DEFAULT null ,
    `assunto` varchar(25) DEFAULT null ,
    `data_hora` date DEFAULT null ,
    `status` varchar(15) DEFAULT null ,
    PRIMARY KEY (`cod`),
    FOREIGN KEY (`materia`) REFERENCES materias(cod),
    FOREIGN KEY (`idProfessor`) REFERENCES funcionarios(id)
);

CREATE TABLE `escola_db`.`turmas` (
    `aula` INT(10) NOT NULL , 
    `aluno` INT(10) NOT NULL , 
    `presenca` INT(1) NOT NULL ,
    FOREIGN KEY (`aula`) REFERENCES aulas(cod),
    FOREIGN KEY (`aluno`) REFERENCES usuarios(id)
);

INSERT INTO `escola_db`.`tipos`(cod, nomeTipo) VALUES (1, 'Gerente');
INSERT INTO `escola_db`.`tipos`(cod, nomeTipo) VALUES (2, 'Professor');
INSERT INTO `escola_db`.`tipos`(cod, nomeTipo) VALUES (3, 'Aluno');

INSERT INTO `escola_db`.`usuarios`(nome, senha) VALUES ('Administrador','admin');
INSERT INTO `escola_db`.`funcionarios`(id, tipo) VALUES (1111111,1);
